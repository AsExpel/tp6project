<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>admin_index</title>
        <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    </head>
<body>
    <input id="exec_input">
    <button onclick="post_exec()">test exec</button>
    <label for="file_input"><input id="file_input" value="1.txt"></label>
    <button onclick="read_file()">reat file</button>
    <div id="append">a</div>

    <script type="text/javascript">
        let url = document.URL + "/index/";
        $(document).ready(
            function (){
          var _url = url + "get_all_bug";
          $.ajax({
            //请求方式
            type: "POST",
            //请求地址
            url: _url,
            //in
            data: '',
            //out
            complete() {},
            success(result) {
              $("#append").empty();
              // console.log(result);
              let item = $.parseJSON(result);
                item.forEach((element, i) => {
                    $("#append").append(function (n) {
                        return(
                            "<div>" +
                            "id:" +
                            element.bug_id +
                            " name:" +
                            element.bug_name +
                            " tag:"+
                            element.bug_tag +
                            "</div>"
                        );
                    }
                    )
                });
              // console.log(item);
            },
            //请求失败，包含具体的错误信息
            error(e) {
              console.log(e.status);
              console.log(e.responseText);
            }
          });

        },
        );
        function post_exec() {
        $get_input = $("input:text[id='exec_input']").val();
        // console.log($get_input);
        var _url = url + "exec_action";
        let command={
          command:$get_input,
        };
        $.ajax({
            //请求方式
            type: "POST",
            //请求地址
            url: _url,
            data: command,
            complete() {},
            success(result) {
                // let _result=$.parse(result);
                // result = encodeURI(encodeURI(result));
                console.log(result);
                // console.log(decodeURIComponent(result.replace(/%/g, '%25')));
            },
            //请求失败，包含具体的错误信息
            error(e) {
                console.log(e.status);
                // console.log(e.responseText);
            }
        });
    }
        function read_file() {
            $get_input = $("input:text[id='file_input']").val();
            // console.log($get_input);
            var _url = url + "read_file";
            let file={
                txtname:$get_input,
            };
            $.ajax({
                //请求方式
                type: "POST",
                //请求地址
                url: _url,
                data: file,
                complete() {},
                success(result) {
                    console.log(result);
                },
                //请求失败，包含具体的错误信息
                error(e) {
                    console.log(e.status);
                    // console.log(e.responseText);
                }
            });
        }


    </script>
</body>
</html>
